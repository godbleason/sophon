version: "3.8"

services:
  sophon:
    build: .
    container_name: sophon
    restart: unless-stopped
    ports:
      - "${PORT:-3000}:${PORT:-3000}"
    volumes:
      # Persist session, memory, and user data
      - ./data:/app/data
      # Optionally mount custom config
      # - ./config:/app/config
      # Optionally mount custom skills
      # - ./skills:/app/skills
    environment:
      # ─── Required ───
      - DEEPSEEK_API_KEY=${DEEPSEEK_API_KEY}
      # ─── Optional: Web Channel ───
      - PORT=${PORT:-3000}
      # ─── Optional: Telegram ───
      - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN:-}
      - SOPHON_TELEGRAM_ENABLED=${SOPHON_TELEGRAM_ENABLED:-true}
      - SOPHON_TELEGRAM_ALLOWED_USERS=${SOPHON_TELEGRAM_ALLOWED_USERS:-}
      # ─── Optional: LLM Config ───
      - SOPHON_MODEL=${SOPHON_MODEL:-}
      - SOPHON_TEMPERATURE=${SOPHON_TEMPERATURE:-}
      - SOPHON_MAX_TOKENS=${SOPHON_MAX_TOKENS:-}
      # ─── Optional: OpenRouter ───
      - OPENROUTER_API_KEY=${OPENROUTER_API_KEY:-}
    env_file:
      - path: .env
        required: false
