# Sophon

è½»é‡çº§å¤šç”¨æˆ· AI åŠ©æ‰‹æ¡†æ¶ã€‚æ”¯æŒå¤šé€šé“äº¤äº’ã€å¤šç”¨æˆ·èº«ä»½ç®¡ç†ã€Space åä½œã€å·¥å…·è°ƒç”¨ã€å®šæ—¶ä»»åŠ¡ã€å­ä»£ç†ã€é•¿æœŸè®°å¿†å’Œ MCP åè®®ã€‚

## ç‰¹æ€§

- **å¤šé€šé“æ¥å…¥** â€” CLI / Webï¼ˆWebSocketï¼‰/ Telegramï¼Œå¯æ‰©å±•æ›´å¤šé€šé“
- **å¤šç”¨æˆ·ç³»ç»Ÿ** â€” è‡ªåŠ¨è¯†åˆ«ç”¨æˆ·èº«ä»½ï¼Œæ”¯æŒè·¨é€šé“å…³è”ï¼ˆåŒä¸€ç”¨æˆ·åœ¨ CLI + Telegram ä½¿ç”¨åŒä¸€èº«ä»½ï¼‰
- **Space åä½œ** â€” åˆ›å»ºå®¶åº­ã€å·¥ä½œç­‰åä½œç©ºé—´ï¼ŒAI è‡ªåŠ¨è¯†åˆ«å¯¹è¯ä¸Šä¸‹æ–‡ï¼Œæ”¯æŒè·¨ç”¨æˆ·æ¶ˆæ¯æ¨é€
- **Agent Loop** â€” å®Œæ•´çš„ LLM å·¥å…·è°ƒç”¨å¾ªç¯ï¼Œæ”¯æŒå¤šè½®è¿­ä»£ã€å¹¶å‘æ§åˆ¶ã€è¿›åº¦æ¨é€å’Œä¼šè¯å–æ¶ˆ
- **å†…ç½®å·¥å…·é›†** â€” æ–‡ä»¶æ“ä½œã€Shell å‘½ä»¤ã€Web æœç´¢ã€æ—¥æœŸæ—¶é—´ã€å®šæ—¶ä»»åŠ¡ã€è®°å¿†ç®¡ç†ã€è·¨ç”¨æˆ·æ¶ˆæ¯ã€å­ä»£ç†
- **å­ä»£ç†ç³»ç»Ÿ** â€” å°†è€—æ—¶ä»»åŠ¡å§”æ‰˜ç»™åå°å­ä»£ç†å¼‚æ­¥æ‰§è¡Œï¼Œå®Œæˆåè‡ªåŠ¨é€šçŸ¥
- **å®šæ—¶ä»»åŠ¡** â€” åŸºäº Cron è¡¨è¾¾å¼çš„ä»»åŠ¡è°ƒåº¦ï¼ŒæŒä¹…åŒ–è‡ªåŠ¨æ¢å¤
- **è®°å¿†ç³»ç»Ÿ** â€” é•¿æœŸäº‹å®è®°å¿† + å†å²æ—¥å¿— + è¯­ä¹‰æœç´¢ï¼Œè·¨ä¼šè¯ä¿ç•™ä¸Šä¸‹æ–‡
- **å¯¹è¯å‹ç¼©** â€” è¶…å‡ºçª—å£çš„å†å²è‡ªåŠ¨ç”± LLM æ‘˜è¦åŒ–ï¼Œä¿ç•™å…³é”®ä¿¡æ¯
- **æŠ€èƒ½ç³»ç»Ÿ** â€” Markdown æ–‡ä»¶å®šä¹‰å¯æ’æ‹”æŠ€èƒ½æç¤ºè¯
- **MCP æ”¯æŒ** â€” ä½œä¸º MCP å®¢æˆ·ç«¯è¿æ¥å¤–éƒ¨å·¥å…·æœåŠ¡å™¨ï¼ˆå…¼å®¹ Cursor / Claude Desktop é…ç½®æ ¼å¼ï¼‰
- **å¤š LLM æ”¯æŒ** â€” OpenAI / DeepSeek / OpenRouterï¼Œç»Ÿä¸€æ¥å£å¯æ‰©å±•
- **æŒä¹…åŒ–æŠ½è±¡å±‚** â€” StorageProvider æ¥å£ï¼Œå½“å‰å®ç° SQLiteï¼ˆbetter-sqlite3ï¼‰ï¼Œå¯æ‰©å±• PostgreSQL ç­‰
- **ç»“æ„åŒ–æ—¥å¿—** â€” åŸºäº pino çš„ JSON æ ¼å¼æ—¥å¿—ï¼Œæ”¯æŒå¤šçº§åˆ«
- **é…ç½®çµæ´»** â€” JSON é…ç½® + `.env` ç¯å¢ƒå˜é‡ + CLI å‚æ•°ï¼Œä¸‰å±‚è¦†ç›–

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 18.0.0

### å®‰è£…

```bash
git clone <repo-url> sophon
cd sophon
npm install
```

### é…ç½®

1. åˆ›å»º `.env` æ–‡ä»¶ï¼Œè®¾ç½® API Keyï¼š

```bash
# è‡³å°‘é…ç½®ä¸€ä¸ª LLM æä¾›å•†
DEEPSEEK_API_KEY=your-api-key-here

# å¯é€‰
OPENAI_API_KEY=your-openai-key
OPENROUTER_API_KEY=your-openrouter-key

# Telegram Botï¼ˆå¯é€‰ï¼‰
TELEGRAM_BOT_TOKEN=your-telegram-bot-token

# Web æœç´¢å¢å¼ºï¼ˆå¯é€‰ï¼Œä¸é…ç½®åˆ™ä½¿ç”¨ DuckDuckGoï¼‰
SERPER_API_KEY=your-serper-key
# æˆ–
SERPAPI_KEY=your-serpapi-key
```

2. é»˜è®¤é…ç½®æ–‡ä»¶ä½äº `config/default.json`ï¼Œå¯æŒ‰éœ€ä¿®æ”¹ï¼Œä¹Ÿå¯åˆ›å»º `config/config.json` è¿›è¡Œè¦†ç›–ã€‚

### å¯åŠ¨

```bash
# å¼€å‘æ¨¡å¼
npm run dev

# æˆ–æ„å»ºåè¿è¡Œ
npm run build
npm start
```

å¯åŠ¨åå°†åŒæ—¶æä¾›ï¼š
- **CLI äº¤äº’** â€” ç»ˆç«¯å†…ç›´æ¥è¾“å…¥å¯¹è¯
- **Web ç•Œé¢** â€” æµè§ˆå™¨è®¿é—® `http://localhost:3000`
- **Telegram Bot** â€” å¦‚å·²é…ç½® Tokenï¼Œè‡ªåŠ¨è¿æ¥

### CLI é€‰é¡¹

```bash
# æŒ‡å®šé…ç½®æ–‡ä»¶
npm run dev -- -c path/to/config.json

# æŒ‡å®šæ¨¡å‹
npm run dev -- -m gpt-4o

# è¯¦ç»†æ—¥å¿—
npm run dev -- -v
```

## é¡¹ç›®ç»“æ„

```
sophon/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ default.json              # é»˜è®¤é…ç½®
â”œâ”€â”€ skills/                       # æŠ€èƒ½å®šä¹‰ï¼ˆMarkdownï¼‰
â”œâ”€â”€ data/                         # è¿è¡Œæ—¶æ•°æ®ï¼ˆgit ignoredï¼‰
â”‚   â”œâ”€â”€ sophon.db                 # SQLite æ•°æ®åº“ï¼ˆç”¨æˆ·ã€Spaceã€è®°å¿†ã€æ¶ˆæ¯ç­‰ï¼‰
â”‚   â””â”€â”€ sessions/                 # ä¼šè¯å·¥ä½œåŒºï¼ˆå·¥å…·äº§ç”Ÿçš„æ–‡ä»¶ï¼‰
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts                  # å…¥å£ï¼ŒCLI å‚æ•°è§£æ
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ config-manager.ts     # é…ç½®åŠ è½½ä¸éªŒè¯ï¼ˆZod Schemaï¼‰
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ app.ts                # åº”ç”¨ç»„è£…ä¸å¯åŠ¨
â”‚   â”‚   â”œâ”€â”€ agent-loop.ts         # Agent å¾ªç¯ï¼ˆLLM â†” å·¥å…·ï¼Œå¹¶å‘æ§åˆ¶ï¼‰
â”‚   â”‚   â”œâ”€â”€ message-bus.ts        # æ¶ˆæ¯æ€»çº¿ï¼ˆå…¥ç«™ / å‡ºç«™ / è¿›åº¦ï¼‰
â”‚   â”‚   â”œâ”€â”€ session-manager.ts    # ä¼šè¯ç®¡ç†ï¼ˆå†…å­˜ç¼“å­˜ + æŒä¹…åŒ–ï¼‰
â”‚   â”‚   â”œâ”€â”€ user-store.ts         # å¤šç”¨æˆ·èº«ä»½ç®¡ç†ä¸è·¨é€šé“å…³è”
â”‚   â”‚   â”œâ”€â”€ space-manager.ts      # Space åä½œç©ºé—´ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ scheduler.ts          # å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨
â”‚   â”‚   â”œâ”€â”€ subagent-manager.ts   # å­ä»£ç†ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ mcp-manager.ts        # MCP å®¢æˆ·ç«¯ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ tool-registry.ts      # å·¥å…·æ³¨å†Œè¡¨
â”‚   â”‚   â”œâ”€â”€ semaphore.ts          # å¹¶å‘ä¿¡å·é‡
â”‚   â”‚   â”œâ”€â”€ async-queue.ts        # å¼‚æ­¥é˜Ÿåˆ—
â”‚   â”‚   â”œâ”€â”€ errors.ts             # é”™è¯¯ç±»å‹
â”‚   â”‚   â””â”€â”€ logger.ts             # æ—¥å¿—ç³»ç»Ÿï¼ˆpinoï¼‰
â”‚   â”œâ”€â”€ storage/
â”‚   â”‚   â”œâ”€â”€ storage-provider.ts   # æŒä¹…åŒ–æŠ½è±¡æ¥å£ï¼ˆStorageProviderï¼‰
â”‚   â”‚   â”œâ”€â”€ sqlite-provider.ts    # SQLite å®ç°ï¼ˆbetter-sqlite3ï¼‰
â”‚   â”‚   â””â”€â”€ index.ts              # ç»Ÿä¸€å¯¼å‡º
â”‚   â”œâ”€â”€ channels/
â”‚   â”‚   â”œâ”€â”€ base-channel.ts       # é€šé“æ¥å£
â”‚   â”‚   â”œâ”€â”€ cli-channel.ts        # CLI é€šé“
â”‚   â”‚   â”œâ”€â”€ web-channel.ts        # Web é€šé“ï¼ˆHTTP + WebSocketï¼‰
â”‚   â”‚   â”œâ”€â”€ web-chat-ui.ts        # Web èŠå¤© UI
â”‚   â”‚   â””â”€â”€ telegram-channel.ts   # Telegram é€šé“
â”‚   â”œâ”€â”€ providers/
â”‚   â”‚   â”œâ”€â”€ openai-compatible-base.ts  # OpenAI å…¼å®¹åŸºç±»
â”‚   â”‚   â”œâ”€â”€ openai-provider.ts
â”‚   â”‚   â”œâ”€â”€ deepseek-provider.ts
â”‚   â”‚   â”œâ”€â”€ openrouter-provider.ts
â”‚   â”‚   â””â”€â”€ provider-factory.ts
â”‚   â”œâ”€â”€ tools/                    # å†…ç½®å·¥å…·é›†
â”‚   â”œâ”€â”€ memory/
â”‚   â”‚   â””â”€â”€ memory-store.ts       # è®°å¿†å­˜å‚¨
â”‚   â”œâ”€â”€ skills/
â”‚   â”‚   â””â”€â”€ skills-loader.ts      # æŠ€èƒ½åŠ è½½å™¨
â”‚   â””â”€â”€ types/                    # TypeScript ç±»å‹å®šä¹‰
â””â”€â”€ package.json
```

## æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CLI Channel â”‚ â”‚  Web Channel â”‚ â”‚ Telegram Channel â”‚  ...
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                â”‚                  â”‚
       â–¼                â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Message Bus                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Agent Loop                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ LLM Providerâ”‚  â”‚ Tool Registry â”‚  â”‚ MCP Tools â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚               â”‚               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”‚   Session   â”‚  â”‚  Memory   â”‚  â”‚  Subagent   â”‚
    â”‚   Manager   â”‚  â”‚   Store   â”‚  â”‚  Manager    â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
    â”‚  User Store â”‚  â”‚ Scheduler â”‚
    â”‚ Space Mgr   â”‚  â”‚           â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
           â”‚               â”‚
           â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              StorageProvider (SQLite)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å†…ç½®å·¥å…·

| å·¥å…· | åç§° | è¯´æ˜ |
|------|------|------|
| ğŸ“ | `read_file` | è¯»å–æ–‡ä»¶å†…å®¹ |
| âœï¸ | `write_file` | å†™å…¥æ–‡ä»¶ |
| ğŸ“‚ | `list_dir` | åˆ—å‡ºç›®å½•å†…å®¹ |
| ğŸ–¥ï¸ | `run_shell` | åœ¨å·¥ä½œåŒºæ‰§è¡Œ Shell å‘½ä»¤ |
| ğŸ• | `get_datetime` | è·å–å½“å‰æ—¥æœŸæ—¶é—´ |
| ğŸ” | `web_search` | Web æœç´¢ï¼ˆDuckDuckGo / Serper / SerpAPIï¼‰ |
| ğŸŒ | `fetch_url` | è·å–ç½‘é¡µå†…å®¹ï¼ˆè‡ªåŠ¨æå–æ­£æ–‡ï¼‰ |
| ğŸ§  | `update_memory` | æ›´æ–°é•¿æœŸè®°å¿† |
| ğŸ“ | `append_history` | è¿½åŠ å†å²æ—¥å¿— |
| ğŸ” | `search_history` | æœç´¢å†å²æ—¥å¿— |
| ğŸ’¬ | `send_message` | å‘ Space æˆå‘˜å‘é€æ¶ˆæ¯ |
| â° | `create_schedule` | åˆ›å»ºå®šæ—¶ä»»åŠ¡ï¼ˆCronï¼‰ |
| ğŸ“‹ | `list_schedules` | åˆ—å‡ºå®šæ—¶ä»»åŠ¡ |
| ğŸ—‘ï¸ | `remove_schedule` | åˆ é™¤å®šæ—¶ä»»åŠ¡ |
| ğŸ”€ | `toggle_schedule` | å¯ç”¨ / ç¦ç”¨å®šæ—¶ä»»åŠ¡ |
| ğŸš€ | `spawn` | ç”Ÿæˆåå°å­ä»£ç† |
| ğŸ“Š | `subagent_status` | æŸ¥è¯¢å­ä»£ç†çŠ¶æ€ |
| âŒ | `cancel_subagent` | å–æ¶ˆå­ä»£ç† |

> é€šè¿‡ MCP è¿æ¥çš„å¤–éƒ¨å·¥å…·æœåŠ¡å™¨ä¼šè‡ªåŠ¨æ³¨å†Œä¸º `mcp_<server>_<tool>` æ ¼å¼çš„å·¥å…·ã€‚

## å†…ç½®å‘½ä»¤

åœ¨å¯¹è¯ä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `/help` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ |
| `/about` | äº†è§£å¹³å°åŠŸèƒ½å’Œ Space ä»‹ç» |
| `/clear` | æ¸…é™¤å½“å‰ä¼šè¯å†å² |
| `/tools` | åˆ—å‡ºå¯ç”¨å·¥å…· |
| `/status` | æ˜¾ç¤ºç³»ç»ŸçŠ¶æ€ |
| `/stop` | åœæ­¢å½“å‰ä»»åŠ¡ |
| `/whoami` | æŸ¥çœ‹å½“å‰ç”¨æˆ·èº«ä»½ |
| `/link` | ç”Ÿæˆè·¨é€šé“å…³è”ç  |
| `/link <code>` | ä½¿ç”¨å…³è”ç ç»‘å®šåˆ°å¦ä¸€ä¸ªé€šé“çš„ç”¨æˆ· |
| `/unlink` | è§£ç»‘å½“å‰é€šé“ |
| `/space create <åç§°>` | åˆ›å»ºä¸€ä¸ªæ–° Space |
| `/space list` | æŸ¥çœ‹æˆ‘åŠ å…¥çš„æ‰€æœ‰ Space |
| `/space info <åç§°æˆ–ID>` | æŸ¥çœ‹ Space è¯¦æƒ… |
| `/space invite <åç§°æˆ–ID>` | ç”Ÿæˆé‚€è¯·ç  |
| `/space join <é‚€è¯·ç >` | é€šè¿‡é‚€è¯·ç åŠ å…¥ Space |
| `/space leave <åç§°æˆ–ID>` | ç¦»å¼€ä¸€ä¸ª Space |
| `/space nick <åç§°æˆ–ID> <æ˜µç§°>` | è®¾ç½®åœ¨æŸä¸ª Space ä¸­çš„æ˜µç§° |
| `/space members <åç§°æˆ–ID>` | æŸ¥çœ‹ Space æˆå‘˜ |

## é…ç½®è¯´æ˜

`config/default.json` å®Œæ•´é…ç½®é¡¹ï¼š

```jsonc
{
  // LLM æä¾›å•†ï¼ˆè‡³å°‘é…ç½®ä¸€ä¸ªï¼ŒAPI Key å»ºè®®æ”¾ .envï¼‰
  "providers": {
    "deepseek": {},
    "openrouter": {},
    "openai": {}
  },

  // ä»£ç†é…ç½®
  "agent": {
    "model": "deepseek-chat",        // ä½¿ç”¨çš„æ¨¡å‹
    "temperature": 0.7,
    "maxTokens": 4096,
    "maxIterations": 50,             // å•æ¬¡å¯¹è¯æœ€å¤§å·¥å…·è°ƒç”¨è½®æ¬¡
    "maxConcurrentMessages": 5,      // å…¨å±€æœ€å¤§å¹¶å‘æ¶ˆæ¯æ•°
    "systemPrompt": "..."
  },

  // å­˜å‚¨é…ç½®
  "storage": {
    "type": "sqlite",                // å­˜å‚¨åç«¯ç±»å‹ï¼ˆç›®å‰æ”¯æŒ sqliteï¼‰
    "sqlitePath": "data/sophon.db"   // SQLite æ•°æ®åº“æ–‡ä»¶è·¯å¾„
  },

  // ä¼šè¯é…ç½®
  "session": {
    "storageDir": "data/sessions",   // å·¥ä½œåŒºæ–‡ä»¶ç›®å½•
    "memoryWindow": 50               // å†å²çª—å£å¤§å°ï¼ˆè¶…å‡ºè‡ªåŠ¨å‹ç¼©æ‘˜è¦ï¼‰
  },

  // è®°å¿†é…ç½®
  "memory": {
    "enabled": true
  },

  // é€šé“é…ç½®
  "channels": {
    "cli": { "enabled": true, "prompt": "you> " },
    "web": { "enabled": true, "port": 3000, "host": "localhost" },
    "telegram": { "enabled": false, "token": "", "allowedUsers": [] }
  },

  // å®šæ—¶ä»»åŠ¡
  "scheduler": {
    "enabled": true,
    "maxTasksPerSession": 20
  },

  // å­ä»£ç†
  "subagent": {
    "enabled": true,
    "maxIterations": 15,
    "maxConcurrent": 5,
    "timeout": 300000,
    "toolBlacklist": ["spawn", "subagent_status", "cancel_subagent"]
  },

  // MCP æœåŠ¡å™¨ï¼ˆå…¼å®¹ Cursor / Claude Desktop æ ¼å¼ï¼‰
  "mcpServers": {
    "example-server": {
      "enabled": true,
      "command": "npx",
      "args": ["-y", "@example/mcp-server"],
      "env": {}
    }
  },

  "logLevel": "info"
}
```

### ç¯å¢ƒå˜é‡

| å˜é‡ | è¯´æ˜ |
|------|------|
| `DEEPSEEK_API_KEY` | DeepSeek API Key |
| `OPENAI_API_KEY` | OpenAI API Key |
| `OPENAI_API_BASE` | OpenAI API åŸºç¡€ URL |
| `OPENROUTER_API_KEY` | OpenRouter API Key |
| `TELEGRAM_BOT_TOKEN` | Telegram Bot Token |
| `SERPER_API_KEY` | Serper.dev æœç´¢ API Key |
| `SERPAPI_KEY` | SerpAPI æœç´¢ API Key |
| `SOPHON_MODEL` | è¦†ç›–é»˜è®¤æ¨¡å‹ |
| `SOPHON_TEMPERATURE` | è¦†ç›–æ¸©åº¦å‚æ•° |
| `SOPHON_LOG_LEVEL` | è¦†ç›–æ—¥å¿—çº§åˆ« |

## æŒä¹…åŒ–æ¶æ„

æ‰€æœ‰æ•°æ®é€šè¿‡ `StorageProvider` æ¥å£ç»Ÿä¸€ç®¡ç†ï¼Œå½“å‰ä½¿ç”¨ SQLite å®ç°ï¼š

| æ•°æ® | å­˜å‚¨æ–¹å¼ | è¯´æ˜ |
|------|----------|------|
| ä¼šè¯å…ƒæ•°æ® | `session_metas` è¡¨ | ä¼šè¯ IDã€é€šé“ã€ç”¨æˆ·å…³è” |
| å¯¹è¯æ¶ˆæ¯ | `messages` è¡¨ | æ¯æ¡æ¶ˆæ¯æœ‰å”¯ä¸€ IDï¼ŒæŒ‰æ’å…¥é¡ºåºæ’åˆ— |
| å¯¹è¯æ‘˜è¦ | `summaries` è¡¨ | å‹ç¼©åçš„æ—§å¯¹è¯æ‘˜è¦ |
| å®šæ—¶ä»»åŠ¡ | `schedules` è¡¨ | Cron ä»»åŠ¡å®šä¹‰ |
| ç”¨æˆ·æ•°æ® | `kv` è¡¨ | ç”¨æˆ·åˆ—è¡¨ JSON |
| Space æ•°æ® | `kv` è¡¨ | Space åˆ—è¡¨ JSON |
| é•¿æœŸè®°å¿† | `kv` è¡¨ | Markdown æ ¼å¼çš„è®°å¿†å†…å®¹ |
| å†å²æ—¥å¿— | `kv` è¡¨ | æ—¶é—´çº¿æ ¼å¼çš„å†å²è®°å½• |

**æ‰©å±•æ–°å­˜å‚¨åç«¯**åªéœ€ä¸‰æ­¥ï¼š
1. å®ç° `StorageProvider` æ¥å£
2. åœ¨é…ç½® Schema ä¸­åŠ å…¥æ–°ç±»å‹
3. åœ¨ `app.ts` ä¸­åŠ å…¥å·¥å‚åˆ†æ”¯

## å¼€å‘

```bash
# ç±»å‹æ£€æŸ¥
npm run lint

# è¿è¡Œæµ‹è¯•
npm test

# ç›‘å¬æ¨¡å¼æµ‹è¯•
npm run test:watch

# æ„å»º
npm run build

# æŸ¥çœ‹å½“å‰é…ç½®
npx tsx src/index.ts config
```

## æŠ€èƒ½ç³»ç»Ÿ

åœ¨ `skills/` ç›®å½•ä¸‹åˆ›å»º Markdown æ–‡ä»¶å³å¯æ·»åŠ æŠ€èƒ½ã€‚æŠ€èƒ½ä¼šè¢«è‡ªåŠ¨æ³¨å…¥åˆ°ç³»ç»Ÿæç¤ºä¸­ã€‚

```markdown
---
name: my-skill
description: æˆ‘çš„è‡ªå®šä¹‰æŠ€èƒ½
always_load: true
---

# æŠ€èƒ½å†…å®¹

è¿™é‡Œå†™æŠ€èƒ½ç›¸å…³çš„æç¤ºè¯æŒ‡å¯¼...
```

## License

MIT
